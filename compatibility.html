<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Compatibility
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A .NET library that provides the full set of financial functions from Excel.">

    <script src="http://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="http://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">

    <link type="text/css" rel="stylesheet" href="/ExcelFinancialFunctions/content/style.css" />
    <script type="text/javascript" src="/ExcelFinancialFunctions/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="http://github.com/fsprojects/ExcelFinancialFunctions">github page</a></li>
        </ul>
        <h3 class="muted"><a href="/ExcelFinancialFunctions/index.html">ExcelFinancialFunctions</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1><a name="Compatibility" class="anchor" href="#Compatibility">Compatibility</a></h1>
<p>This library replicates Excel behavior. There're 199,252 tests verifying the results against Excel 2010 and their number can be raised significantly by adding new test values. Several tests check the function properties, e.g. that bond duration can't be greater than maturity.<br />
The current version matches Excel 2010, which is slightly different from 2003, see <a href="http://blogs.office.com/b/microsoft-excel/archive/2009/09/10/function-improvements-in-excel-2010.aspx">Function Improvements in Excel 2010</a>.
Note, that console tests require Excel, whereas the unit tests can be run even on mono - their parameters and expected results are stored in files.</p>
<p>However, there're still some differences comparing to Excel.
<em>Read more about OpenOffice vs Excel <a href="openofficediff.html">here</a>.</em></p>
<h2><a name="COUPDAYS" class="anchor" href="#COUPDAYS">COUPDAYS</a></h2>
<p>The Excel algorithm doesn't respect equality <code>coupDays = coupDaysBS + coupDaysNC</code>. The library result differs from Excel by +/- one or two days when the date spans a leap year. (<a href="http://office.microsoft.com/en-us/excel/HP052090311033.aspx">office docs</a>)</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">settlement</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="t">DateTime</span>(<span class="n">2012</span>, <span class="n">1</span>, <span class="n">1</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="i">maturity</span>   <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 7)" onmouseover="showTip(event, 'fs5', 7)" class="t">DateTime</span>(<span class="n">2016</span>, <span class="n">2</span>, <span class="n">29</span>)

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs7', 8)" onmouseover="showTip(event, 'fs7', 8)" class="i">param</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs4', 9)" onmouseover="showTip(event, 'fs4', 9)" class="i">settlement</span>, <span onmouseout="hideTip(event, 'fs6', 10)" onmouseover="showTip(event, 'fs6', 10)" class="i">maturity</span>, <span onmouseout="hideTip(event, 'fs8', 11)" onmouseover="showTip(event, 'fs8', 11)" class="t">Frequency</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs9', 12)" onmouseover="showTip(event, 'fs9', 12)" class="i">SemiAnnual</span>, <span onmouseout="hideTip(event, 'fs10', 13)" onmouseover="showTip(event, 'fs10', 13)" class="t">DayCountBasis</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs11', 14)" onmouseover="showTip(event, 'fs11', 14)" class="i">ActualActual</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs12', 15)" onmouseover="showTip(event, 'fs12', 15)" class="i">days</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs13', 16)" onmouseover="showTip(event, 'fs13', 16)" class="t">Financial</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs14', 17)" onmouseover="showTip(event, 'fs14', 17)" class="f">CoupDays</span> <span onmouseout="hideTip(event, 'fs7', 18)" onmouseover="showTip(event, 'fs7', 18)" class="i">param</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs15', 19)" onmouseover="showTip(event, 'fs15', 19)" class="i">bs</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs13', 20)" onmouseover="showTip(event, 'fs13', 20)" class="t">Financial</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 21)" onmouseover="showTip(event, 'fs16', 21)" class="f">CoupDaysBS</span> <span onmouseout="hideTip(event, 'fs7', 22)" onmouseover="showTip(event, 'fs7', 22)" class="i">param</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs17', 23)" onmouseover="showTip(event, 'fs17', 23)" class="i">nc</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs13', 24)" onmouseover="showTip(event, 'fs13', 24)" class="t">Financial</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 25)" onmouseover="showTip(event, 'fs18', 25)" class="f">CoupDaysNC</span> <span onmouseout="hideTip(event, 'fs7', 26)" onmouseover="showTip(event, 'fs7', 26)" class="i">param</span>
<span class="c">// Excel: 2</span>
<span onmouseout="hideTip(event, 'fs12', 27)" onmouseover="showTip(event, 'fs12', 27)" class="i">days</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs15', 28)" onmouseover="showTip(event, 'fs15', 28)" class="i">bs</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs17', 29)" onmouseover="showTip(event, 'fs17', 29)" class="i">nc</span>
<span class="fsi">val days : float = 182.0</span>
<span class="fsi">val bs : float = 123.0</span>
<span class="fsi">val nc : float = 59.0</span>
<span class="fsi">val it : float = 0.0</span>
</code></pre></td>
</tr>
</table>
<h2><a name="VDB" class="anchor" href="#VDB">VDB</a></h2>
<p>In the Excel version of this algorithm the depreciation in the period (0,1) is not the same as the sum of the depreciations in periods (0,0.5) (0.5,1)<br />
Notice that in Excel by using '1' (no_switch) instead of '0' as the last parameter everything works as expected.<br />
In truth, the last parameter should have no influence in the calculation given that in the first period there is no switch to sln depreciation.<br />
Overall, the algorithm is correct, even if it disagrees with Excel when startperiod is fractional. (<a href="http://office.microsoft.com/en-us/excel/HP052093341033.aspx">office docs</a>)</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs19', 30)" onmouseover="showTip(event, 'fs19', 30)" class="f">vdb</span> <span onmouseout="hideTip(event, 'fs20', 31)" onmouseover="showTip(event, 'fs20', 31)" class="i">sp</span> <span onmouseout="hideTip(event, 'fs21', 32)" onmouseover="showTip(event, 'fs21', 32)" class="i">ep</span> <span onmouseout="hideTip(event, 'fs22', 33)" onmouseover="showTip(event, 'fs22', 33)" class="i">switch</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs13', 34)" onmouseover="showTip(event, 'fs13', 34)" class="t">Financial</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 35)" onmouseover="showTip(event, 'fs23', 35)" class="f">Vdb</span>(<span class="n">100.0</span>, <span class="n">10.0</span>, <span class="n">13.0</span>, <span onmouseout="hideTip(event, 'fs20', 36)" onmouseover="showTip(event, 'fs20', 36)" class="i">sp</span>, <span onmouseout="hideTip(event, 'fs21', 37)" onmouseover="showTip(event, 'fs21', 37)" class="i">ep</span>, <span class="n">1.0</span>, 
        <span class="k">if</span> <span onmouseout="hideTip(event, 'fs22', 38)" onmouseover="showTip(event, 'fs22', 38)" class="i">switch</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs24', 39)" onmouseover="showTip(event, 'fs24', 39)" class="t">VdbSwitch</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs25', 40)" onmouseover="showTip(event, 'fs25', 40)" class="i">SwitchToStraightLine</span> <span class="k">else</span> <span onmouseout="hideTip(event, 'fs24', 41)" onmouseover="showTip(event, 'fs24', 41)" class="t">VdbSwitch</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 42)" onmouseover="showTip(event, 'fs26', 42)" class="i">DontSwitchToStraightLine</span>)

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs27', 43)" onmouseover="showTip(event, 'fs27', 43)" class="i">p1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 44)" onmouseover="showTip(event, 'fs19', 44)" class="f">vdb</span> <span class="n">0.0</span> <span class="n">0.5</span> <span class="k">false</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs28', 45)" onmouseover="showTip(event, 'fs28', 45)" class="i">p2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 46)" onmouseover="showTip(event, 'fs19', 46)" class="f">vdb</span> <span class="n">0.5</span> <span class="n">1.0</span> <span class="k">false</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs29', 47)" onmouseover="showTip(event, 'fs29', 47)" class="i">total</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 48)" onmouseover="showTip(event, 'fs19', 48)" class="f">vdb</span> <span class="n">0.0</span> <span class="n">1.0</span> <span class="k">false</span>
<span class="c">// Excel: 0.1479</span>
<span onmouseout="hideTip(event, 'fs29', 49)" onmouseover="showTip(event, 'fs29', 49)" class="i">total</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs27', 50)" onmouseover="showTip(event, 'fs27', 50)" class="i">p1</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs28', 51)" onmouseover="showTip(event, 'fs28', 51)" class="i">p2</span> 
<span class="fsi">val p1 : float = 3.846153846</span>
<span class="fsi">val p2 : float = 3.846153846</span>
<span class="fsi">val total : float = 7.692307692</span>
<span class="fsi">val it : float = 0.0</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs30', 52)" onmouseover="showTip(event, 'fs30', 52)" class="i">p1sw</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 53)" onmouseover="showTip(event, 'fs19', 53)" class="f">vdb</span> <span class="n">0.0</span> <span class="n">0.5</span> <span class="k">true</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs31', 54)" onmouseover="showTip(event, 'fs31', 54)" class="i">p2sw</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 55)" onmouseover="showTip(event, 'fs19', 55)" class="f">vdb</span> <span class="n">0.5</span> <span class="n">1.0</span> <span class="k">true</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs32', 56)" onmouseover="showTip(event, 'fs32', 56)" class="i">totalsw</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 57)" onmouseover="showTip(event, 'fs19', 57)" class="f">vdb</span> <span class="n">0.0</span> <span class="n">1.0</span> <span class="k">true</span>
<span class="c">// Excel: 0.0000</span>
<span onmouseout="hideTip(event, 'fs32', 58)" onmouseover="showTip(event, 'fs32', 58)" class="i">totalsw</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs30', 59)" onmouseover="showTip(event, 'fs30', 59)" class="i">p1sw</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs31', 60)" onmouseover="showTip(event, 'fs31', 60)" class="i">p2sw</span> 
<span class="fsi">val p1sw : float = 3.846153846</span>
<span class="fsi">val p2sw : float = 3.846153846</span>
<span class="fsi">val totalsw : float = 7.692307692</span>
<span class="fsi">val it : float = 0.0</span>
</code></pre></td>
</tr>
</table>
<h2><a name="AMORDEGRC" class="anchor" href="#AMORDEGRC">AMORDEGRC</a></h2>
<p>ExcelCompliant is used because Excel stores 13 digits. AmorDegrc algorithm rounds numbers<br />
and returns different results unless the numbers get rounded to 13 digits before rounding them.<br />
I.E. 22.49999999999999 is considered 22.5 by Excel, but 22.4 by the .NET framework. (<a href="http://office.microsoft.com/en-us/excel/HP052089841033.aspx">office docs</a>)</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs33', 61)" onmouseover="showTip(event, 'fs33', 61)" class="f">amorDegrc</span> <span onmouseout="hideTip(event, 'fs34', 62)" onmouseover="showTip(event, 'fs34', 62)" class="i">excelCompliant</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs13', 63)" onmouseover="showTip(event, 'fs13', 63)" class="t">Financial</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 64)" onmouseover="showTip(event, 'fs35', 64)" class="f">AmorDegrc</span>(<span class="n">100.0</span>, <span onmouseout="hideTip(event, 'fs5', 65)" onmouseover="showTip(event, 'fs5', 65)" class="t">DateTime</span>(<span class="n">2014</span>,<span class="n">1</span>,<span class="n">1</span>), <span onmouseout="hideTip(event, 'fs5', 66)" onmouseover="showTip(event, 'fs5', 66)" class="t">DateTime</span>(<span class="n">2016</span>,<span class="n">1</span>,<span class="n">1</span>), 
        <span class="n">50.0</span>, <span class="n">1.0</span>, <span class="n">0.3</span>, <span onmouseout="hideTip(event, 'fs10', 67)" onmouseover="showTip(event, 'fs10', 67)" class="t">DayCountBasis</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs11', 68)" onmouseover="showTip(event, 'fs11', 68)" class="i">ActualActual</span>, <span onmouseout="hideTip(event, 'fs34', 69)" onmouseover="showTip(event, 'fs34', 69)" class="i">excelCompliant</span>)

<span onmouseout="hideTip(event, 'fs33', 70)" onmouseover="showTip(event, 'fs33', 70)" class="f">amorDegrc</span> <span class="k">true</span>
<span class="fsi">val it : float = 23.0</span>
<span onmouseout="hideTip(event, 'fs33', 71)" onmouseover="showTip(event, 'fs33', 71)" class="f">amorDegrc</span> <span class="k">false</span>
<span class="fsi">val it : float = 22.0</span>
</code></pre></td>
</tr>
</table>
<h2><a name="DDB" class="anchor" href="#DDB">DDB</a></h2>
<p>Excel Ddb has two interesting characteristics:<br />
1. It special cases ddb for fractional periods between 0 and 1 by considering them to be 1<br />
2. It is inconsistent with VDB(..., True) for fractional periods, even if VDB(..., True) is defined to be the same as ddb. The algorithm for VDB is theoretically correct.<br />
This function makes the same 1. adjustment.(<a href="http://office.microsoft.com/en-us/excel/HP052090511033.aspx">office docs</a>)</p>
<h2><a name="RATE-and-ODDFYIELD" class="anchor" href="#RATE-and-ODDFYIELD">RATE and ODDFYIELD</a></h2>
<p>Excel uses a different root finding algo. Sometimes the library results are better, sometimes Excel's. (<a href="http://office.microsoft.com/en-us/excel/HP052092321033.aspx">office docs</a>)</p>
<h2><a name="XIRR-and-XNPV" class="anchor" href="#XIRR-and-XNPV">XIRR and XNPV</a></h2>
<p>XIRR and XNPV functions are related: the net present value, given the internal rate of return, should be zero.
However, XNPV works only for positive rates even though the XIRR results might be negative.
The results can also be different because of the root finding functions. (<a href="http://office.microsoft.com/en-us/excel/HP052093411033.aspx">office docs</a>)</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs36', 72)" onmouseover="showTip(event, 'fs36', 72)" class="i">dates</span> <span class="o">=</span> [|<span onmouseout="hideTip(event, 'fs5', 73)" onmouseover="showTip(event, 'fs5', 73)" class="t">DateTime</span>(<span class="n">2000</span>, <span class="n">2</span>, <span class="n">29</span>); <span onmouseout="hideTip(event, 'fs5', 74)" onmouseover="showTip(event, 'fs5', 74)" class="t">DateTime</span>(<span class="n">2000</span>, <span class="n">3</span>, <span class="n">31</span>)|]
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs37', 75)" onmouseover="showTip(event, 'fs37', 75)" class="i">values</span> <span class="o">=</span> [|<span class="n">206101714.849377</span>; <span class="o">-</span><span class="n">156650972.54265</span>|]
<span class="c">// Excel: -0.960452189</span>
<span onmouseout="hideTip(event, 'fs13', 76)" onmouseover="showTip(event, 'fs13', 76)" class="t">Financial</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs38', 77)" onmouseover="showTip(event, 'fs38', 77)" class="f">XIrr</span>(<span onmouseout="hideTip(event, 'fs37', 78)" onmouseover="showTip(event, 'fs37', 78)" class="i">values</span>, <span onmouseout="hideTip(event, 'fs36', 79)" onmouseover="showTip(event, 'fs36', 79)" class="i">dates</span>, <span class="o">-</span><span class="n">0.1</span>)
<span class="fsi">val it : float = -0.960452195</span>
<span class="c">// Excel: #NUM!</span>
<span onmouseout="hideTip(event, 'fs13', 80)" onmouseover="showTip(event, 'fs13', 80)" class="t">Financial</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs39', 81)" onmouseover="showTip(event, 'fs39', 81)" class="f">XNpv</span>(<span class="o">-</span><span class="n">0.960452195</span>, <span onmouseout="hideTip(event, 'fs37', 82)" onmouseover="showTip(event, 'fs37', 82)" class="i">values</span>, <span onmouseout="hideTip(event, 'fs36', 83)" onmouseover="showTip(event, 'fs36', 83)" class="i">dates</span>)
<span class="fsi">val it : float = -0.008917063475</span>
<span class="c">// Excel: #NUM!</span>
<span onmouseout="hideTip(event, 'fs13', 84)" onmouseover="showTip(event, 'fs13', 84)" class="t">Financial</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs39', 85)" onmouseover="showTip(event, 'fs39', 85)" class="f">XNpv</span>(<span class="o">-</span><span class="n">0.960452189</span>, <span onmouseout="hideTip(event, 'fs37', 86)" onmouseover="showTip(event, 'fs37', 86)" class="i">values</span>, <span onmouseout="hideTip(event, 'fs36', 87)" onmouseover="showTip(event, 'fs36', 87)" class="i">dates</span>)
<span class="fsi">val it : float = 2.646784514</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs40', 88)" onmouseover="showTip(event, 'fs40', 88)" class="i">values2</span> <span class="o">=</span> [|<span class="n">15108163.3840923</span>; <span class="o">-</span><span class="n">75382259.6628424</span>|]
<span class="c">// Excel: #NUM!</span>
<span onmouseout="hideTip(event, 'fs13', 89)" onmouseover="showTip(event, 'fs13', 89)" class="t">Financial</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs38', 90)" onmouseover="showTip(event, 'fs38', 90)" class="f">XIrr</span>(<span onmouseout="hideTip(event, 'fs40', 91)" onmouseover="showTip(event, 'fs40', 91)" class="i">values2</span>, <span onmouseout="hideTip(event, 'fs36', 92)" onmouseover="showTip(event, 'fs36', 92)" class="i">dates</span>, <span class="o">-</span><span class="n">0.1</span>)
<span class="fsi">val it : float = 165601346.1</span>
<span class="c">// Excel: 165601345.6</span>
<span onmouseout="hideTip(event, 'fs13', 93)" onmouseover="showTip(event, 'fs13', 93)" class="t">Financial</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs38', 94)" onmouseover="showTip(event, 'fs38', 94)" class="f">XIrr</span>(<span onmouseout="hideTip(event, 'fs40', 95)" onmouseover="showTip(event, 'fs40', 95)" class="i">values2</span>, <span onmouseout="hideTip(event, 'fs36', 96)" onmouseover="showTip(event, 'fs36', 96)" class="i">dates</span>, <span class="n">0.1</span>)
<span class="fsi">val it : float = 165601346.1</span>
<span onmouseout="hideTip(event, 'fs13', 97)" onmouseover="showTip(event, 'fs13', 97)" class="t">Financial</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs39', 98)" onmouseover="showTip(event, 'fs39', 98)" class="f">XNpv</span>(<span class="n">165601346.1</span>, <span onmouseout="hideTip(event, 'fs40', 99)" onmouseover="showTip(event, 'fs40', 99)" class="i">values2</span>, <span onmouseout="hideTip(event, 'fs36', 100)" onmouseover="showTip(event, 'fs36', 100)" class="i">dates</span>)
<span class="fsi">val it : float = -0.000269997865</span>
<span onmouseout="hideTip(event, 'fs13', 101)" onmouseover="showTip(event, 'fs13', 101)" class="t">Financial</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs39', 102)" onmouseover="showTip(event, 'fs39', 102)" class="f">XNpv</span>(<span class="n">165601345.6</span>, <span onmouseout="hideTip(event, 'fs40', 103)" onmouseover="showTip(event, 'fs40', 103)" class="i">values2</span>, <span onmouseout="hideTip(event, 'fs36', 104)" onmouseover="showTip(event, 'fs36', 104)" class="i">dates</span>)
<span class="fsi">val it : float = -0.004144238308</span>
</code></pre></td>
</tr>
</table>

<div class="tip" id="fs1">namespace System</div>
<div class="tip" id="fs2">namespace Excel</div>
<div class="tip" id="fs3">namespace Excel.FinancialFunctions</div>
<div class="tip" id="fs4">val settlement : DateTime<br /><br />Full name: Compatibility.settlement</div>
<div class="tip" id="fs5">Multiple items<br />type DateTime =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : ticks:int64 -&gt; DateTime + 10 overloads<br />&#160;&#160;&#160;&#160;member Add : value:TimeSpan -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddDays : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddHours : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMilliseconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMinutes : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMonths : months:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddSeconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddTicks : value:int64 -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddYears : value:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.DateTime<br /><br />--------------------<br />DateTime()<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, calendar: Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, calendar: Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>
<div class="tip" id="fs6">val maturity : DateTime<br /><br />Full name: Compatibility.maturity</div>
<div class="tip" id="fs7">val param : DateTime * DateTime * Frequency * DayCountBasis<br /><br />Full name: Compatibility.param</div>
<div class="tip" id="fs8">type Frequency =<br />&#160;&#160;|  Annual  =  1<br />&#160;&#160;|  SemiAnnual  =  2<br />&#160;&#160;|  Quarterly  =  4<br /><br />Full name: Excel.FinancialFunctions.Frequency</div>
<div class="tip" id="fs9">Frequency.SemiAnnual: Frequency = 2</div>
<div class="tip" id="fs10">type DayCountBasis =<br />&#160;&#160;|  UsPsa30_360  =  0<br />&#160;&#160;|  ActualActual  =  1<br />&#160;&#160;|  Actual360  =  2<br />&#160;&#160;|  Actual365  =  3<br />&#160;&#160;|  Europ30_360  =  4<br /><br />Full name: Excel.FinancialFunctions.DayCountBasis</div>
<div class="tip" id="fs11">DayCountBasis.ActualActual: DayCountBasis = 1</div>
<div class="tip" id="fs12">val days : float<br /><br />Full name: Compatibility.days</div>
<div class="tip" id="fs13">type Financial =<br />&#160;&#160;static member AccrInt : issue:DateTime * firstInterest:DateTime * settlement:DateTime * rate:float * par:float * frequency:Frequency * basis:DayCountBasis -&gt; float<br />&#160;&#160;static member AccrInt : issue:DateTime * firstInterest:DateTime * settlement:DateTime * rate:float * par:float * frequency:Frequency * basis:DayCountBasis * calcMethod:AccrIntCalcMethod -&gt; float<br />&#160;&#160;static member AccrIntM : issue:DateTime * settlement:DateTime * rate:float * par:float * basis:DayCountBasis -&gt; float<br />&#160;&#160;static member AmorDegrc : cost:float * datePurchased:DateTime * firstPeriod:DateTime * salvage:float * period:float * rate:float * basis:DayCountBasis * excelCompliant:bool -&gt; float<br />&#160;&#160;static member AmorLinc : cost:float * datePurchased:DateTime * firstPeriod:DateTime * salvage:float * period:float * rate:float * basis:DayCountBasis -&gt; float<br />&#160;&#160;static member CoupDays : settlement:DateTime * maturity:DateTime * frequency:Frequency * basis:DayCountBasis -&gt; float<br />&#160;&#160;static member CoupDaysBS : settlement:DateTime * maturity:DateTime * frequency:Frequency * basis:DayCountBasis -&gt; float<br />&#160;&#160;static member CoupDaysNC : settlement:DateTime * maturity:DateTime * frequency:Frequency * basis:DayCountBasis -&gt; float<br />&#160;&#160;static member CoupNCD : settlement:DateTime * maturity:DateTime * frequency:Frequency * basis:DayCountBasis -&gt; DateTime<br />&#160;&#160;static member CoupNum : settlement:DateTime * maturity:DateTime * frequency:Frequency * basis:DayCountBasis -&gt; float<br />&#160;&#160;...<br /><br />Full name: Excel.FinancialFunctions.Financial</div>
<div class="tip" id="fs14">static member Financial.CoupDays : settlement:DateTime * maturity:DateTime * frequency:Frequency * basis:DayCountBasis -&gt; float</div>
<div class="tip" id="fs15">val bs : float<br /><br />Full name: Compatibility.bs</div>
<div class="tip" id="fs16">static member Financial.CoupDaysBS : settlement:DateTime * maturity:DateTime * frequency:Frequency * basis:DayCountBasis -&gt; float</div>
<div class="tip" id="fs17">val nc : float<br /><br />Full name: Compatibility.nc</div>
<div class="tip" id="fs18">static member Financial.CoupDaysNC : settlement:DateTime * maturity:DateTime * frequency:Frequency * basis:DayCountBasis -&gt; float</div>
<div class="tip" id="fs19">val vdb : sp:float -&gt; ep:float -&gt; switch:bool -&gt; float<br /><br />Full name: Compatibility.vdb</div>
<div class="tip" id="fs20">val sp : float</div>
<div class="tip" id="fs21">val ep : float</div>
<div class="tip" id="fs22">val switch : bool</div>
<div class="tip" id="fs23">static member Financial.Vdb : cost:float * salvage:float * life:float * startPeriod:float * endPeriod:float -&gt; float<br />static member Financial.Vdb : cost:float * salvage:float * life:float * startPeriod:float * endPeriod:float * factor:float -&gt; float<br />static member Financial.Vdb : cost:float * salvage:float * life:float * startPeriod:float * endPeriod:float * factor:float * noSwitch:VdbSwitch -&gt; float</div>
<div class="tip" id="fs24">type VdbSwitch =<br />&#160;&#160;|  DontSwitchToStraightLine  =  1<br />&#160;&#160;|  SwitchToStraightLine  =  0<br /><br />Full name: Excel.FinancialFunctions.VdbSwitch</div>
<div class="tip" id="fs25">VdbSwitch.SwitchToStraightLine: VdbSwitch = 0</div>
<div class="tip" id="fs26">VdbSwitch.DontSwitchToStraightLine: VdbSwitch = 1</div>
<div class="tip" id="fs27">val p1 : float<br /><br />Full name: Compatibility.p1</div>
<div class="tip" id="fs28">val p2 : float<br /><br />Full name: Compatibility.p2</div>
<div class="tip" id="fs29">val total : float<br /><br />Full name: Compatibility.total</div>
<div class="tip" id="fs30">val p1sw : float<br /><br />Full name: Compatibility.p1sw</div>
<div class="tip" id="fs31">val p2sw : float<br /><br />Full name: Compatibility.p2sw</div>
<div class="tip" id="fs32">val totalsw : float<br /><br />Full name: Compatibility.totalsw</div>
<div class="tip" id="fs33">val amorDegrc : excelCompliant:bool -&gt; float<br /><br />Full name: Compatibility.amorDegrc</div>
<div class="tip" id="fs34">val excelCompliant : bool</div>
<div class="tip" id="fs35">static member Financial.AmorDegrc : cost:float * datePurchased:DateTime * firstPeriod:DateTime * salvage:float * period:float * rate:float * basis:DayCountBasis * excelCompliant:bool -&gt; float</div>
<div class="tip" id="fs36">val dates : DateTime []<br /><br />Full name: Compatibility.dates</div>
<div class="tip" id="fs37">val values : float []<br /><br />Full name: Compatibility.values</div>
<div class="tip" id="fs38">static member Financial.XIrr : values:seq&lt;float&gt; * dates:seq&lt;DateTime&gt; -&gt; float<br />static member Financial.XIrr : values:seq&lt;float&gt; * dates:seq&lt;DateTime&gt; * guess:float -&gt; float</div>
<div class="tip" id="fs39">static member Financial.XNpv : rate:float * values:seq&lt;float&gt; * dates:seq&lt;DateTime&gt; -&gt; float</div>
<div class="tip" id="fs40">val values2 : float []<br /><br />Full name: Compatibility.values2</div>

        </div>
        <div class="span3">
	  <a href="https://nuget.org/packages/ExcelFinancialFunctions">
            <img src="/ExcelFinancialFunctions/img/logo.png" style="width:140px;height:140px;margin:10px 0px 0px 35px;border-style:none;" />
          </a>

          <ul class="nav nav-list" id="menu">
            <li class="nav-header">ExcelFinancialFunctions</li>
            <li><a href="/ExcelFinancialFunctions/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="http://nuget.org/packages/ExcelFinancialFunctions">Get Library via NuGet</a></li>
            <li><a href="http://github.com/fsprojects/ExcelFinancialFunctions">Source Code on GitHub</a></li>
            <li><a href="http://github.com/fsprojects/ExcelFinancialFunctions/blob/master/LICENSE.txt">License</a></li>
            <li><a href="http://github.com/fsprojects/ExcelFinancialFunctions/blob/master/RELEASE_NOTES.md">Release Notes</a></li>
            
            <li class="nav-header">Documentation</li>
            <li><a href="/ExcelFinancialFunctions/reference/index.html">API Reference</a></li>
            <li><a href="/ExcelFinancialFunctions/compatibility.html">Excel Compatibility</a></li>
            <li><a href="/ExcelFinancialFunctions/openofficediff.html">OpenOffice Differences</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/fsprojects/ExcelFinancialFunctions"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png" alt="Fork me on GitHub"></a>
  </body>
  </html>
